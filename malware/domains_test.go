package malware

import "testing"

func TestGetDatabase(t *testing.T) {
	if database, err := getDataBase(); err != nil {
		t.Error(err)
	} else {
		if len(database) < 1000 {
			t.Errorf("Database too short, check if everything is correct: %#v", database)
		}
	}
}

func TestDomainCheck(t *testing.T) {
	domains := []string{
		"luckytidy.info/some_page",
		"inlinea.co.uk/suspended.page",
		"sexzoznamka.eu/lightbox/js/r/files/tasks/AC",
		"pride-u-bike.com/motorcycle/vozdeniye-motorcycle/",
		"pokachi.net/search?pak=chi",
	}
	if badDomains, err := DomainCheck(domains); err != nil {
		t.Error(err)
	} else if len(badDomains) != len(domains) {
		t.Errorf("Error detecting domain, only %v of %v detected", badDomains, domains)
	}
}

